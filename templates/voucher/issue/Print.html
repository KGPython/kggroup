{% load basefilter %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>打印预览页</title>
</head>
<body>
{% include 'common/head.html' %}

<style media="print">
    * {
        margin: 0;
        padding: 0;
        background: #fff;
    }

    nav, aside {
        display: none;
    }

    .noprint {
        display: none
    }

    .glyphicon {
        display: none
    }
</style>

<style>
    .A4_longitudinal {
        margin-top: 2mm;
        margin-bottom: 2mm;
        margin-left: 2mm;
        margin-right: 2mm;
        width: 210mm;
        height: 297mm;
    }

    .A4_transverse {
        margin-top: 2mm;
        margin-bottom: 2mm;
        margin-left: 2mm;
        margin-right: 2mm;
        width: 297mm;
        height: 210mm;
    }

    .v_print {
        border: 1px solid #000;
        margin-top: 1.5mm;
        margin-bottom: 1.5mm;
        margin-left: 1.5mm;
        margin-right: 1.5mm;
        width: 95mm;
    {#        height: {{ v_print_height }};#} float: left;
    }

    .v_print .v_title {
        font-size: 18px;
    }

    .v_print .v_image {
        height: 18mm;
    }

    .v_print .v_tb {
        margin-left: 8mm;
        margin-right: 8mm;
        width: 79mm;
        height: 26mm;
        font-size: 12px;
    }

    .v_print .v_tb .v_tr {
        height: 10px;
    }

    .v_print .v_foot {
        margin-bottom: 1px;
    }
</style>
<!--containt-part-->
<div id="content">
    <input type="button" class="noprint btn btn-warning btn-sm" onclick='printcode()' value="打印预览">
    {% for var_i in page_count %}
        <div class="{{ A4_class }}">
            {% for var_j in range_tnop %}
                {% if var_i|multiply:tnop|add:var_j < counts %}
                    <div class="v_print" style="text-align:center">
                        <label class="v_title">宽广超市{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'couponname' }}</label>
                        <div class="v_image"
                             id="{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'couponno' }}">
                        </div>
                        <label class="v_sn">
                            {{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'couponno' }}</label>
                        {#                        {% if var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'coupontypeid' == 3 %}#}
                        <table class="v_tb">
                            <tr class="v_tr">
                                <th colspan="2">
                                    发行店：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'shopid' | transShopCode }}</th>
                                <th>
                                    类型：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'coupontypeid' | transCouponTypeByChinese }}</th>
                            </tr>
                            <tr class="v_tr">
                                <th>商品名称</th>
                                <th>数量</th>
                                <th>商品编码</th>
                            </tr>
                            {% for var_good in var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'GoodList' %}
                                <tr class="v_tr">
                                    <td>{{ var_good.goodname }}</td>
                                    <td>{{ var_good.amount }}</td>
                                    <td>{{ var_good.goodcode }}</td>
                                </tr>
                            {% endfor %}
                            <tr class="v_tr">
                                <th colspan="2" style="text-align: left">
                                    使用范围：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'rangeremark' }}</th>
                                <th>V：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'value' }}</th>
                            </tr>
                        </table>
                        {#                        {% else %}#}
                        {#                            <table class="v_tb">#}
                        {#                                <tr style="font-size:18px">#}
                        {#                                    <th>#}
                        {#                                        制作门店：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'shopid'| transShopCode }}</th>#}
                        {#                                    <th>券类型：B</th>#}
                        {#                                </tr>#}
                        {#                                <tr style="font-size:25px">#}
                        {#                                    <td colspan="2">#}
                        {#                                        券总额：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'value' }}元#}
                        {#                                    </td>#}
                        {#                                </tr>#}
                        {#                                <tr class="v_tr">#}
                        {#                                    <th colspan="2" style="text-align: left">#}
                        {#                                        使用范围：{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'rangeremark' }}</th>#}
                        {#                                </tr>#}
                        {#                            </table>#}

                        {#                        {% endif %}#}
                        <label class="v_foot"
                               style=" font-size:8px">本券请于{{ var_i|multiply:tnop|add:var_j|o_index:resList|o_column:'enddate' }}前使用<br/>逾期作废，丢失不补，盖章有效
                        </label>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
        <p style="page-break-after:always;"></p>
    {% endfor %}

</div>
<!--end-containt-part-->

{% include "common/foot.html" %}
<script type="text/javascript" src="{{ static }}/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="{{ static }}/js/jquery-barcode.js"></script>

<script type="text/javascript">
    function printcode() {
        var arr =
        {{snlist |safe}}
        for (var i = 0; i < arr.length; i++) {
            var sn = arr[i]
            $("#" + sn).empty().barcode(sn, "code128", {
                barWidth: 2,
                barHeight: $(".v_print .v_image").height(),
                showHRI: false
            })
        }
        window.print()
    }
</script>
</body>
</html>
