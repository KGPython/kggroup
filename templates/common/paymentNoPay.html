<div class="widget-box payment">
    <div class="widget-title"> <span class="icon"> <span class="glyphicon glyphicon-th"> </span></span>
        <h5>支付管理</h5>
        <span class="icon-add-btn">
            <input type="button" class="btn btn-success btn-xs pull-right" id="sumPayments" value="支付合计">
        </span>

    </div>
    <div class="widget-content nopadding">
        <table class="table table-striped table-hover table-form-my">
            <thead>
                <tr>
                    <th>选择</th>
                    <th>支付方式</th>
                    <th>支付额度</th>
                    <th>备注</th>
                </tr>
            </thead>
            <tbody class="payList">
                <tr>
                    <td><input value="1" type="checkbox"></td>
                    <td><input type='text' class='form-control payName' value="现金" disabled></td>
                    <td><input type='text' class='form-control payVal'></td>
                    <td><input type='text' class='form-control'></td>
                </tr>

                <tr>
                    <td><input value="3" type="checkbox"></td>
                    <td><input type='text' class='form-control payName' value="汇款" disabled></td>
                    <td><input type='text' class='form-control payVal'></td>
                    <td><input type='text' class='form-control'></td>
                </tr>
                <tr>
                    <td><input value="5" type="checkbox"></td>
                    <td><input type='text' class='form-control payName' value="POS消费" disabled></td>
                    <td><input type='text' class='form-control payVal'></td>
                    <td><input type='text' class='form-control'></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<script>
//计算混合支付的合计金额
$(document).on('click','.payment #sumPayments',function(){
    palyList = $('.payList').find('tr');
    var totalStr = '';
    var payTotal=0;
    var payIdList = [];
    for(var i=0;i<palyList.length;i++){
        var checkBox = $(palyList[i]).find('td').eq(0).find('input')[0];
        var flag = $(checkBox).is(':checked');
        var payName = '';
        var payVal= $(palyList[i]).find('td').eq(2).find('input').val();
        if(flag && payVal){
            var cardSaleTotalVal = parseFloat($(".Total #totalVal b").text());
            var payId =0;
            //获取支付ID
            payId = $(palyList[i]).find('td').eq(0).find('input[type=checkbox]').val();
            payName = $(palyList[i]).find('td').eq(1).find('input').val();

            totalStr += payName +' : '+payVal+'元 ';
            remarks = $(palyList[i]).find('td').eq(3).find('input').val();
            if(remarks){
                totalStr += '(备注：'+remarks+'), ';
            }else{
                totalStr += ', ';
            }
            payTotal +=parseFloat(payVal);
        }
    }
    $('.Total #payInfo span').html(totalStr);
    $('.Total #payTotal b').html(payTotal)
});

</script>
